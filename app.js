eval(atob("CiAgICAgICAgLy8gQ09ORklHVVJBVElPTiBERVMgU0PDiU5BUklPUwogICAgICAgIC8vIFJlbXBsYWNlIGxlcyBub21zIGRlIGZpY2hpZXJzIHBhciB0ZXMgaW1hZ2VzIGfDqW7DqXLDqWVzIChleDogJ3dhci5qcGcnKQogICAgICAgIGNvbnN0IHNjZW5hcmlvcyA9IHsKICAgICAgICAgICAgMTogeyBpbWc6ICJwZXNzaW1pc3RlLmpwZyIsIHRpdGxlOiAiR0xPQkFMIEhBQklUQUJJTElUWSBJTkRFWCBISVRTIFpFUk8uIiB9LAogICAgICAgICAgICAyOiB7IGltZzogImd1ZXJyZS5qcGciLCB0aXRsZTogIkdFTy1XQVJGQVJFIERFQ0xBUkVEIElOIEFSQ1RJQy4iIH0sCiAgICAgICAgICAgIDM6IHsgaW1nOiAib3B0aW1pc3RlLmpwZyIsIHRpdGxlOiAiRVRFUk5BTCBXSElURSBTS1kgUFJPSkVDVCBCRUdJTlMuIiB9CiAgICAgICAgfTsKCiAgICAgICAgLy8gTU9UUyBDTMOJUyBQT1VSIExBIFNJTVVMQVRJT04gKMOHYSBmYWl0ICJNYXRyaXgiKQogICAgICAgIGNvbnN0IGtleXdvcmRzID0gWyJXQVIiLCAiSE9QRSIsICJGQU1JTkUiLCAiSUNFIiwgIkRST1VHSFQiLCAiU1VSVklWQUwiLCAiQ09MTEFQU0UiLCAiVEVDSE5PTE9HWSIsICJSVVNTSUEiLCAiSU5ESUEiLCAiU1lTVEVNIEZBSUxVUkUiXTsKCiAgICAgICAgbGV0IGN1cnJlbnRTdGVwID0gMTsKCiAgICAgICAgLy8gRUNPVVRFVVIgQ0xBVklFUiAoQydlc3QgdGEgdMOpbMOpY29tbWFuZGUpCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkgewoKICAgICAgICAgICAgLy8gRVNQQUNFIDogUGFzc2VyIGR1IFFSIENvZGUgYXUgUHJvY2Vzc2luZwogICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ1NwYWNlJyAmJiBjdXJyZW50U3RlcCA9PT0gMSkgewogICAgICAgICAgICAgICAgY3VycmVudFN0ZXAgPSAyOwogICAgICAgICAgICAgICAgc3dpdGNoVmlldygnc3RlcC0yJyk7CiAgICAgICAgICAgICAgICBzdGFydFByb2Nlc3NpbmdTaW11bGF0aW9uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRPVUNIRVMgMSwgMiwgMyA6IETDqWNsZW5jaGVyIGxlIFJldmVhbCBjb3JyZXNwb25kYW50CiAgICAgICAgICAgIGlmIChjdXJyZW50U3RlcCA9PT0gMikgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJzEnKSB0cmlnZ2VyUmV2ZWFsKDEpOyAvLyBQZXNzaW1pc3RlCiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnMicpIHRyaWdnZXJSZXZlYWwoMik7IC8vIEd1ZXJyZQogICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJzMnKSB0cmlnZ2VyUmV2ZWFsKDMpOyAvLyBPcHRpbWlzdGUKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBmdW5jdGlvbiBzd2l0Y2hWaWV3KGlkKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy52aWV3JykuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICB9CiAgICAgICAgLy8gU2ltdWxlIGxlIGTDqWZpbGVtZW50IGRlIGNvZGUgZXQgZGUgbW90cyBjbMOpcwogICAgICAgIGZ1bmN0aW9uIHN0YXJ0UHJvY2Vzc2luZ1NpbXVsYXRpb24oKSB7CiAgICAgICAgICAgIGNvbnN0IHdvcmRDbG91ZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3b3JkLWNsb3VkJyk7CiAgICAgICAgICAgIGNvbnN0IGNvbnNvbGVMb2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uc29sZS1sb2cnKTsKCiAgICAgICAgICAgIC8vIFBIWVNJQ1MgRU5HSU5FIFNUQVRFCiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVdvcmRPYmplY3RzID0gW107IC8vIFN0b3JlcyB7ZWwsIHgsIHksIHZ4LCB2eSwgd2lkdGgsIGhlaWdodCwgbWFzc30KICAgICAgICAgICAgbGV0IGFuaW1hdGlvbkZyYW1lSWQ7CiAgICAgICAgICAgIGxldCB0aW1lb3V0SWQ7CgogICAgICAgICAgICAvLyBUSU1JTkcgQ09ORklHCiAgICAgICAgICAgIGNvbnN0IFRPVEFMX0RVUkFUSU9OID0gMjUwMDA7IC8vIDI1IHNlY29uZHMKICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTsKCiAgICAgICAgICAgIC8vIFNUQVJUIFBIWVNJQ1MgTE9PUAogICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVQaHlzaWNzKCkgewogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGVwICE9PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uRnJhbWVJZCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIEdldCBDb25zb2xlIEJvdW5kaW5nIEJveCBmb3IgY29sbGlzaW9uCiAgICAgICAgICAgICAgICBjb25zdCBjb25zb2xlUmVjdCA9IGNvbnNvbGVMb2cuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXJSZWN0ID0gd29yZENsb3VkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgICAgICAgICAgIGFjdGl2ZVdvcmRPYmplY3RzLmZvckVhY2goKG9iaiwgaSkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBkaW1lbnNpb25zIGJhc2VkIG9uIGN1cnJlbnQgRE9NIHNpemUgKGlmIGdyb3dpbmcpCiAgICAgICAgICAgICAgICAgICAgb2JqLndpZHRoID0gb2JqLmVsLm9mZnNldFdpZHRoOwogICAgICAgICAgICAgICAgICAgIG9iai5oZWlnaHQgPSBvYmouZWwub2Zmc2V0SGVpZ2h0OwoKICAgICAgICAgICAgICAgICAgICAvLyAxLiBhcHBseSBmb3JjZXMKICAgICAgICAgICAgICAgICAgICAvLyBDZW50ZXIgR3Jhdml0eSAod2VhayBwdWxsIHRvIHNjcmVlbiBjZW50ZXIpCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IGNvbnRhaW5lclJlY3Qud2lkdGggLyAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7CiAgICAgICAgICAgICAgICAgICAgb2JqLnZ4ICs9IChjZW50ZXJYIC0gb2JqLngpICogMC4wMDI7CiAgICAgICAgICAgICAgICAgICAgb2JqLnZ5ICs9IChjZW50ZXJZIC0gb2JqLnkpICogMC4wMDI7CgogICAgICAgICAgICAgICAgICAgIC8vIFJlcHVsc2lvbiBmcm9tIG90aGVyIHdvcmRzCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhY3RpdmVXb3JkT2JqZWN0cy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gaikgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG90aGVyID0gYWN0aXZlV29yZE9iamVjdHNbal07CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkeCA9IG9iai54IC0gb3RoZXIueDsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHkgPSBvYmoueSAtIG90aGVyLnk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW5EaXN0ID0gKG9iai53aWR0aCAvIDIgKyBvdGhlci53aWR0aCAvIDIpICogMS4yOyAvLyBBZGQgcGFkZGluZwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3QgPCBtaW5EaXN0ICYmIGRpc3QgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JjZSA9IChtaW5EaXN0IC0gZGlzdCkgKiAwLjE7IC8vIFNwcmluZyBmb3JjZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnggPSBkeCAvIGRpc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBueSA9IGR5IC8gZGlzdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai52eCArPSBueCAqIGZvcmNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnZ5ICs9IG55ICogZm9yY2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIFJlcHVsc2lvbiBmcm9tIENvbnNvbGUgKFN0cm9uZyBGb3JjZSkKICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbGUgQUFCQiBjaGVjayArIFJlcHVsc2lvbgogICAgICAgICAgICAgICAgICAgIC8vIENvbnNvbGUgaXMgYXQgYm90dG9tIHJpZ2h0LCBzbyB3ZSB1c3VhbGx5IGp1c3QgcHVzaCBVcC9MZWZ0CiAgICAgICAgICAgICAgICAgICAgLy8gTWFwIHBoeXNpY3MgY29vcmRpbmF0ZXMgKHJlbGF0aXZlIHRvIGNvbnRhaW5lcikgdG8gc2NyZWVuIGNvb3JkcwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjcmVlblggPSBjb250YWluZXJSZWN0LmxlZnQgKyBvYmoueDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3JlZW5ZID0gY29udGFpbmVyUmVjdC50b3AgKyBvYmoueTsKCiAgICAgICAgICAgICAgICAgICAgLy8gZGVmaW5lIHNhZmV0eSBtYXJnaW4KICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJnaW4gPSA1MDsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlblggKyBvYmoud2lkdGggLyAyICsgbWFyZ2luID4gY29uc29sZVJlY3QubGVmdCAmJgogICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5ZICsgb2JqLmhlaWdodCAvIDIgKyBtYXJnaW4gPiBjb25zb2xlUmVjdC50b3AKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHVzaCBhd2F5IHN0cm9uZ2x5CiAgICAgICAgICAgICAgICAgICAgICAgIG9iai52eCAtPSAyOwogICAgICAgICAgICAgICAgICAgICAgICBvYmoudnkgLT0gMjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIFdhbGwgQm91bmRhcmllcwogICAgICAgICAgICAgICAgICAgIGlmIChvYmoueCA8IG9iai53aWR0aCAvIDIpIG9iai52eCArPSAxOwogICAgICAgICAgICAgICAgICAgIGlmIChvYmoueCA+IGNvbnRhaW5lclJlY3Qud2lkdGggLSBvYmoud2lkdGggLyAyKSBvYmoudnggLT0gMTsKICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnkgPCBvYmouaGVpZ2h0IC8gMikgb2JqLnZ5ICs9IDE7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai55ID4gY29udGFpbmVyUmVjdC5oZWlnaHQgLSBvYmouaGVpZ2h0IC8gMikgb2JqLnZ5IC09IDE7CgogICAgICAgICAgICAgICAgICAgIC8vIDIuIHVwZGF0ZSB2ZWxvY2l0eSAmIHBvc2l0aW9uCiAgICAgICAgICAgICAgICAgICAgb2JqLnZ4ICo9IDAuOTsgLy8gRnJpY3Rpb24KICAgICAgICAgICAgICAgICAgICBvYmoudnkgKj0gMC45OwogICAgICAgICAgICAgICAgICAgIG9iai54ICs9IG9iai52eDsKICAgICAgICAgICAgICAgICAgICBvYmoueSArPSBvYmoudnk7CgogICAgICAgICAgICAgICAgICAgIC8vIDMuIGFwcGx5IHRvIERPTQogICAgICAgICAgICAgICAgICAgIC8vIENlbnRlcmluZyB0aGUgZWxlbWVudCBvbiB4LHkKICAgICAgICAgICAgICAgICAgICBvYmouZWwuc3R5bGUubGVmdCA9IChvYmoueCAtIG9iai53aWR0aCAvIDIpICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICBvYmouZWwuc3R5bGUudG9wID0gKG9iai55IC0gb2JqLmhlaWdodCAvIDIpICsgJ3B4JzsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGFuaW1hdGlvbkZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlUGh5c2ljcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXBkYXRlUGh5c2ljcygpOwoKCiAgICAgICAgICAgIC8vIEVWRU5UIFNDSEVEVUxFUiAoQmVsbCBDdXJ2ZSBUaW1pbmcpCiAgICAgICAgICAgIGZ1bmN0aW9uIHNjaGVkdWxlTmV4dEV2ZW50KCkgewogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGVwICE9PSAyKSByZXR1cm47CgogICAgICAgICAgICAgICAgY29uc3QgZWxhcHNlZCA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7CiAgICAgICAgICAgICAgICBpZiAoZWxhcHNlZCA+PSBUT1RBTF9EVVJBVElPTikgewogICAgICAgICAgICAgICAgICAgIC8vIEVORCBTSU1VTEFUSU9OOiBQRUFDRUZVTCBTVEFURQogICAgICAgICAgICAgICAgICAgIC8vIDEuIFN0b3AgU3Bhd25pbmcgKGRvbid0IHNjaGVkdWxlIG5leHQgdGltZW91dCkKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gMi4gQ29udGludWUgUGh5c2ljcyAoZG8gbm90aGluZyB0byBhbmltYXRpb25GcmFtZUlkKQoKICAgICAgICAgICAgICAgICAgICAvLyAzLiBDb25zb2xlIEVuZCBTdGF0ZQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGVMb2cuc3R5bGUuYW5pbWF0aW9uID0gJ25vbmUnOyAvLyBTdG9wIGdsaXRjaAogICAgICAgICAgICAgICAgICAgIGNvbnNvbGVMb2cuc3R5bGUuYm9yZGVyQ29sb3IgPSAnI0Y0RjFFQSc7IC8vIFN0YWJsZSBib3JkZXIKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgbG9nLmNsYXNzTmFtZSA9ICdsb2ctZW50cnknOwogICAgICAgICAgICAgICAgICAgIGxvZy5zdHlsZS5jb2xvciA9ICcjRjRGMUVBJzsKICAgICAgICAgICAgICAgICAgICBsb2cuc3R5bGUuYm9yZGVyVG9wID0gJzFweCBzb2xpZCAjRjRGMUVBJzsKICAgICAgICAgICAgICAgICAgICBsb2cuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOwogICAgICAgICAgICAgICAgICAgIGxvZy5zdHlsZS5wYWRkaW5nVG9wID0gJzEwcHgnOwogICAgICAgICAgICAgICAgICAgIGxvZy5pbm5lclRleHQgPSBgPiBTWVNURU0gQU5BTFlTSVMgQ09NUExFVEUuXG4+IFdBSVRJTkcgRk9SIFVTRVIgSU5QVVQuLi5gOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGVMb2cuYXBwZW5kQ2hpbGQobG9nKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlTG9nLnNjcm9sbFRvcCA9IGNvbnNvbGVMb2cuc2Nyb2xsSGVpZ2h0OwoKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gQ0FMQ1VMQVRFIERFTEFZCiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IGVsYXBzZWQgLyBUT1RBTF9EVVJBVElPTjsgLy8gMC4wIHRvIDEuMAogICAgICAgICAgICAgICAgLy8gQmVsbCBjdXJ2ZTogSGlnaCBkZWxheSBhdCBlbmRzLCBMb3cgZGVsYXkgaW4gbWlkZGxlICgwLjUpCiAgICAgICAgICAgICAgICAvLyBDdXJ2ZTogeSA9IHwwLjUgLSBwfCAqIDIgLT4gZ29lcyBmcm9tIDEgdG8gMCB0byAxCiAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZSA9IE1hdGguYWJzKDAuNSAtIHByb2dyZXNzKSAqIDI7CiAgICAgICAgICAgICAgICAvLyBEZWxheSByYW5nZTogMTAwbXMgKGZhc3Rlc3QpIHRvIDEyMDBtcyAoc2xvd2VzdCkKICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gMTAwICsgKGN1cnZlICogMTEwMCk7CgogICAgICAgICAgICAgICAgLy8gRE8gQUNUSU9OCiAgICAgICAgICAgICAgICBzcGF3bk9yVXBkYXRlKCk7CgogICAgICAgICAgICAgICAgLy8gU0NIRURVTEUgTkVYVAogICAgICAgICAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChzY2hlZHVsZU5leHRFdmVudCwgZGVsYXkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgcGlkQ291bnQgPSAwOwogICAgICAgICAgICBjb25zdCBhY3RpdmVXb3Jkc01hcCA9IHt9OyAvLyB0ZXh0IC0+IG9iamVjdCByZWYKCiAgICAgICAgICAgIGZ1bmN0aW9uIHNwYXduT3JVcGRhdGUoKSB7CiAgICAgICAgICAgICAgICAvLyAxLiBDT05TT0xFIExPRwogICAgICAgICAgICAgICAgcGlkQ291bnQrKzsKICAgICAgICAgICAgICAgIGNvbnN0IGxvZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgbG9nLmNsYXNzTmFtZSA9ICdsb2ctZW50cnknOwogICAgICAgICAgICAgICAgY29uc3QgaGV4ID0gJzB4JyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJhbmRvbVdvcmRGb3JMb2cgPSBrZXl3b3Jkc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBrZXl3b3Jkcy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgIGxvZy5pbm5lclRleHQgPSBgWyR7aGV4fV0gUElEXyR7cGlkQ291bnR9OiBQUk9DRVNTICR7cmFuZG9tV29yZEZvckxvZ30uLi5gOwogICAgICAgICAgICAgICAgY29uc29sZUxvZy5hcHBlbmRDaGlsZChsb2cpOwogICAgICAgICAgICAgICAgY29uc29sZUxvZy5zY3JvbGxUb3AgPSBjb25zb2xlTG9nLnNjcm9sbEhlaWdodDsKICAgICAgICAgICAgICAgIGlmIChjb25zb2xlTG9nLmNoaWxkcmVuLmxlbmd0aCA+IDE1KSBjb25zb2xlTG9nLnJlbW92ZUNoaWxkKGNvbnNvbGVMb2cuZmlyc3RDaGlsZCk7CgoKICAgICAgICAgICAgICAgIC8vIDIuIFdPUkQgQ0xPVUQgQUNUSU9OCiAgICAgICAgICAgICAgICBjb25zdCByYW5kb21Xb3JkID0ga2V5d29yZHNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICoga2V5d29yZHMubGVuZ3RoKV07CgogICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVdvcmRzTWFwW3JhbmRvbVdvcmRdKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gR1JPVyBFWElTVElORwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iaiA9IGFjdGl2ZVdvcmRzTWFwW3JhbmRvbVdvcmRdOwogICAgICAgICAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VGbG9hdChvYmouZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXNpemUnKSk7CiAgICAgICAgICAgICAgICAgICAgc2l6ZSArPSAwLjU7IC8vIEdyb3cKICAgICAgICAgICAgICAgICAgICBvYmouZWwuc3R5bGUuZm9udFNpemUgPSBzaXplICsgJ3JlbSc7CiAgICAgICAgICAgICAgICAgICAgb2JqLmVsLnNldEF0dHJpYnV0ZSgnZGF0YS1zaXplJywgc2l6ZSk7CgogICAgICAgICAgICAgICAgICAgIC8vIEZsYXNoCiAgICAgICAgICAgICAgICAgICAgb2JqLmVsLnN0eWxlLmNvbG9yID0gJyNmZjAwMDAnOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gb2JqLmVsLnN0eWxlLmNvbG9yID0gJyNCNzFDMUMnLCAyMDApOwoKICAgICAgICAgICAgICAgICAgICAvLyBBZGQgIkV4Y2l0ZSIgZm9yY2UgKHB1c2ggbmVpZ2hib3JzIHNsaWdodGx5IG9uIGdyb3d0aCkKICAgICAgICAgICAgICAgICAgICBvYmoubWFzcyArPSAxOyAvLyBnZXQgaGVhdmllcgoKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gU1BBV04gTkVXCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd29yZEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgd29yZEVsLmNsYXNzTmFtZSA9ICdmbG9hdGluZy13b3JkJzsKICAgICAgICAgICAgICAgICAgICB3b3JkRWwuaW5uZXJUZXh0ID0gcmFuZG9tV29yZDsKICAgICAgICAgICAgICAgICAgICB3b3JkRWwuc2V0QXR0cmlidXRlKCdkYXRhLXNpemUnLCAnMS41Jyk7CiAgICAgICAgICAgICAgICAgICAgd29yZEVsLnN0eWxlLmZvbnRTaXplID0gJzEuNXJlbSc7CiAgICAgICAgICAgICAgICAgICAgd29yZENsb3VkLmFwcGVuZENoaWxkKHdvcmRFbCk7CgogICAgICAgICAgICAgICAgICAgIC8vIEluaXRpYWwgUG9zaXRpb246IFJhbmRvbSBidXQgdHJ5IHRvIGF2b2lkIGNvbnNvbGUKICAgICAgICAgICAgICAgICAgICAvLyBKdXN0IHNwYXduIG5lYXIgY2VudGVyIGZvciAiYnViYmxlIiBlZmZlY3QsIHBoeXNpY3Mgd2lsbCBwdXNoIHRoZW0gb3V0CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHdvcmRDbG91ZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFggPSBjb250YWluZXJSZWN0LndpZHRoIC8gMiArIChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDEwMDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFkgPSBjb250YWluZXJSZWN0LmhlaWdodCAvIDIgKyAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAxMDA7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgZWw6IHdvcmRFbCwKICAgICAgICAgICAgICAgICAgICAgICAgeDogc3RhcnRYLAogICAgICAgICAgICAgICAgICAgICAgICB5OiBzdGFydFksCiAgICAgICAgICAgICAgICAgICAgICAgIHZ4OiAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiA1LCAvLyByYW5kb20gdmVsb2NpdHkKICAgICAgICAgICAgICAgICAgICAgICAgdnk6IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDUsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAwLCAvLyB3aWxsIGJlIHNldCBpbiBmcmFtZSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgbWFzczogMQogICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgIGFjdGl2ZVdvcmRPYmplY3RzLnB1c2gob2JqKTsKICAgICAgICAgICAgICAgICAgICBhY3RpdmVXb3Jkc01hcFtyYW5kb21Xb3JkXSA9IG9iajsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGxvb3AKICAgICAgICAgICAgc2NoZWR1bGVOZXh0RXZlbnQoKTsKICAgICAgICB9CgogICAgICAgIC8vIEFmZmljaGUgbCdpbWFnZSBmaW5hbGUKICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyUmV2ZWFsKGlkKSB7CiAgICAgICAgICAgIGN1cnJlbnRTdGVwID0gMzsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IHNjZW5hcmlvc1tpZF07CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaW5hbC1pbWcnKS5zcmMgPSBkYXRhLmltZzsKICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0ZXh0IGluc2lkZSB0aGUgbWFycXVlZSBzcGFuCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWFkbGluZS10ZXh0JykuaW5uZXJUZXh0ID0gZGF0YS50aXRsZSArICIgICAvLy8gICAiICsgZGF0YS50aXRsZSArICIgICAvLy8gICAiICsgZGF0YS50aXRsZTsKICAgICAgICAgICAgc3dpdGNoVmlldygnc3RlcC0zJyk7CiAgICAgICAgfQoKICAgIA=="));